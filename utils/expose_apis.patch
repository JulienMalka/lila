diff --git a/src/libutil-c/nix_api_util.cc b/src/libutil-c/nix_api_util.cc
index 4f65a4c12..01a223d6a 100644
--- a/src/libutil-c/nix_api_util.cc
+++ b/src/libutil-c/nix_api_util.cc
@@ -3,6 +3,9 @@
 #include "error.hh"
 #include "nix_api_util_internal.h"
 #include "util.hh"
+#include "source-path.hh"
+#include "posix-source-accessor.hh"
+#include "file-content-address.hh"
 
 #include <cxxabi.h>
 #include <typeinfo>
@@ -142,6 +145,14 @@ nix_err nix_err_code(const nix_c_context * read_context)
     return read_context->last_err_code;
 }
 
+const char * hash_path(const char * path) {
+    nix::Hash hash = nix::hashPath(
+        nix::PosixSourceAccessor::createAtRoot(path),
+        nix::FileIngestionMethod::NixArchive,
+        nix::HashAlgorithm::SHA256).first;
+    return strdup(hash.to_string(nix::HashFormat::Nix32, false).c_str());
+}
+
 // internal
 nix_err call_nix_get_string_callback(const std::string str, nix_get_string_callback callback, void * user_data)
 {
diff --git a/src/libutil-c/nix_api_util.h b/src/libutil-c/nix_api_util.h
index ad6f32859..3a8e36210 100644
--- a/src/libutil-c/nix_api_util.h
+++ b/src/libutil-c/nix_api_util.h
@@ -293,6 +293,8 @@ nix_err nix_err_code(const nix_c_context * read_context);
  */
 nix_err nix_set_err_msg(nix_c_context * context, nix_err err, const char * msg);
 
+const char * hash_path(const char * path);
+
 /**
  *  @}
  */
